Facter.add(:hostint_ipv4_max) do
  confine :kernel => %w{Linux Darwin FreeBSD}
  int=Facter.value('hostint')
  setcode do
    mask = Facter.value("netmask_#{int}")
    if mask == '255.255.255.255'
      '1'
    elsif mask == '255.255.255.254'
      '2'
    elsif mask == '255.255.255.252'
      '4'
    elsif mask == '255.255.255.248'
      '8'
    elsif mask == '255.255.255.240'
      '16'
    elsif mask == '255.255.255.224'
      '32'
    elsif mask == '255.255.255.192'
      '64'
    elsif mask == '255.255.255.128'
      '128'
    elsif mask == '255.255.255.0'
      '256'
    elsif mask == '255.255.254.0'
      '512'
    elsif mask == '255.255.252.0'
      '1024'
    elsif mask == '255.255.248.0'
      '2048'
    elsif mask == '255.255.240.0'
      '4096'
    elsif mask == '255.255.224.0'
      '8192'
    elsif mask == '255.255.192.0'
      '16384'
    elsif mask == '255.255.128.0'
      '32768'
    elsif mask == '255.255.0.0'
      '65536'
    elsif mask == '255.254.0.0'
      '131072'
    elsif mask == '255.252.0.0'
      '262144'
    elsif mask == '255.248.0.0'
      '524288'
    elsif mask == '255.240.0.0'
      '1048576'
    elsif mask == '255.224.0.0'
      '2097152'
    elsif mask == '255.192.0.0'
      '4194304'
    elsif mask == '255.128.0.0'
      '8388608'
    elsif mask == '255.0.0.0'
      '16777216'
    elsif mask == '254.0.0.0'
      '33554432'
    elsif mask == '252.0.0.0'
      '67108864'
    elsif mask == '248.0.0.0'
      '134217728'
    elsif mask == '240.0.0.0'
      '268435456'
    elsif mask == '224.0.0.0'
      '536870912'
    elsif mask == '192.0.0.0'
      '1073741824'
    elsif mask == '128.0.0.0'
      '2147483648'
    elsif mask == '0.0.0.0'
      '4294967296'
    else 
      nil
    end
  end
end
